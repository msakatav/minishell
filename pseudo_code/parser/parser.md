# parser.c 疑似コード

## 関数: count_args
- **引数**:
  - `tokens`: トークンリスト
- **処理**:
  1. パイプまたはリスト末尾までループする:
     - トークンが `TOKEN_WORD` ならカウントを増やす。
     - トークンがリダイレクトなら、次のトークン（ファイル名）もスキップする。
     - 次のトークンへ進む。
  2. カウントを返す。

## 関数: parse_args
- **引数**:
  - `tokens`: トークンリストへのポインタ
  - `quote_types`: クォートタイプ配列へのポインタ
- **処理**:
  1. `count_args` で引数の数を数える。
  2. 引数配列 `args` とクォートタイプ配列 `quotes` のメモリを確保する。
  3. パイプまたはリスト末尾までループする:
     - トークンが `TOKEN_WORD` の場合:
       - 値を複製して `args` に格納する。
       - クォートタイプを `quotes` に格納する。
       - インデックスを進める。
       - トークンを進める。
     - トークンがリダイレクトの場合:
       - トークンを2つ進める（リダイレクト記号とファイル名）。
     - その他の場合、トークンを進める。
  4. 配列の最後に `NULL` (args) と `0` (quotes) を設定する。
  5. `quote_types` に `quotes` を設定する。
  6. `args` を返す。

## 関数: parse_redirections
- **引数**:
  - `tokens`: トークンリストへのポインタ
- **処理**:
  1. リダイレクトリスト `redirs` を `NULL` に初期化する。
  2. パイプまたはリスト末尾までループする:
     - トークンがリダイレクトの場合:
       - リダイレクトの種類を保存する。
       - トークンを進める。
       - 次のトークンが `TOKEN_WORD` なら:
         - `new_redir` で新しいリダイレクトノードを作成する。
         - `add_redir` でリストに追加する。
         - トークンを進める。
     - その他の場合、トークンを進める。
  3. `redirs` を返す。

## 関数: parse_command
- **引数**:
  - `tokens`: トークンリストへのポインタ
- **処理**:
  1. `new_cmd` で新しいコマンド構造体を作成する。
  2. トークンの開始位置を保存する。
  3. `parse_redirections` を呼び出し、リダイレクトを解析して格納する。
  4. トークン位置を元に戻す。
  5. `parse_args` を呼び出し、引数を解析して格納する。
  6. トークンポインタを更新する。
  7. コマンド構造体を返す。

## 関数: parser
- **引数**:
  - `tokens`: トークンリスト
- **処理**:
  1. コマンドリスト `cmds` を `NULL` に初期化する。
  2. トークンリストがある間ループする:
     - `parse_command` を呼び出し、コマンドを解析する。
     - 解析されたコマンドを `add_cmd` でリストに追加する。
     - 現在のトークンがパイプなら、次のトークンへ進む。
  3. コマンドリストを返す。
