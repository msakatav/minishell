# parser_redir.c 疑似コード

## 関数: handle_redir_error
- **引数**:
  - `token`: エラーが発生したトークン
  - `data`: シェルの主要データ構造体
  - `error`: エラーフラグへのポインタ
- **処理**:
  1. トークンが存在し、かつ `TOKEN_EMPTY_EXPANSION` の場合:
     - エラーメッセージ "minishell: ambiguous redirect" を出力する。
     - 終了ステータスを 1 に設定する。
  2. それ以外の場合:
     - エラーメッセージ "minishell: syntax error near unexpected token `...'" を出力する。
       - トークンがあればその値を、なければ "newline" を表示する。
     - 終了ステータスを 258 に設定する。
  3. `error` フラグを 1 に設定する。

## 関数: process_redir
- **引数**:
  - `tokens`: トークンリストへのポインタ
  - `redirs`: リダイレクトリストへのポインタ
  - `data`: シェルの主要データ構造体
  - `error`: エラーフラグへのポインタ
- **戻り値**:
  - 成功: 1
  - 失敗: 0
- **処理**:
  1. 現在のトークンのタイプを保存し、トークンを次に進める。
  2. 次のトークンが存在し、かつ `TOKEN_WORD` の場合:
     - `new_redir` で新しいリダイレクトノードを作成する。
     - `add_redir` でリストに追加する。
     - トークンをさらに次に進める。
  3. それ以外の場合:
     - `handle_redir_error` を呼び出してエラー処理を行う。
     - 0 を返す。
  4. 1 を返す。

## 関数: parse_redirections
- **引数**:
  - `tokens`: トークンリストへのポインタ
  - `data`: シェルの主要データ構造体
  - `error`: エラーフラグへのポインタ
- **戻り値**:
  - リダイレクトリスト
- **処理**:
  1. リダイレクトリスト `redirs` を `NULL` に初期化する。
  2. `error` フラグを 0 に初期化する。
  3. トークンが存在し、かつパイプでない間ループする:
     - トークンがリダイレクト (`TOKEN_REDIR_IN` 〜 `TOKEN_REDIR_HEREDOC`) の場合:
       - `process_redir` を呼び出してリダイレクトを処理する。
       - 処理に失敗した場合:
         - `free_redirs` で作成済みのリストを解放する。
         - `NULL` を返す。
     - それ以外の場合、トークンを次に進める。
  4. `redirs` を返す。