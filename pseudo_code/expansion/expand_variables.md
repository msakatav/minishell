# expand_variables.c 疑似コード

## 関数: get_var_name
- **引数**:
  - `str`: 文字列
  - `i`: 現在のインデックスへのポインタ
- **処理**:
  1. 現在位置が `?` の場合、インデックスを進めて `?` という文字列を返す。
  2. 現在位置が数字の場合、変数名として無効なので `NULL` を返す。
  3. 現在位置が英数字または `_` でない場合、`NULL` を返す。
  4. 英数字または `_` が続く限りインデックスを進める。
  5. 抽出した変数名を返す。

## 関数: get_var_value
- **引数**:
  - `var_name`: 変数名
  - `data`: シェルの主要データ構造体
- **処理**:
  1. 変数名が `?` の場合、`data->exit_status` を文字列化して返す。
  2. `get_env_value` で環境変数の値を取得する。
  3. 値が存在すれば複製して返す。
  4. 存在しなければ空文字を返す。

## 関数: expand_single_var
- **引数**:
  - `str`: 文字列
  - `i`: 現在のインデックスへのポインタ
  - `data`: シェルの主要データ構造体
- **処理**:
  1. インデックスをインクリメントする (`$` をスキップ)。
  2. `get_var_name` で変数名を取得する。
  3. 変数名が無効または空の場合:
     - `$` という文字列を返す。
  4. `get_var_value` で変数の値を取得する。
  5. 変数名を解放する。
  6. 変数の値を返す。

## 関数: expand_variables
- **引数**:
  - `str`: 展開対象の文字列
  - `data`: シェルの主要データ構造体
- **処理**:
  1. 結果文字列 `result` を空文字で初期化する。
  2. 文字列 `str` を走査するループ:
     - `$` が出現するまでの部分文字列を特定する。
     - その部分文字列を `result` に結合する。
     - `$` が見つかった場合:
       - `expand_single_var` を呼び出し、変数を展開する。
       - 展開結果を `result` に結合する。
  3. `result` を返す。
